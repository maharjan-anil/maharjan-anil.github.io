<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Nexus Video Library</title>
<link rel="icon" type="image/png" sizes="32x32" href="favicon.png">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
:root {
--bg-dark: #030305;
--bg-card: #0d0d12;
--bg-card-hover: #12121a;
--bg-glass: rgba(13, 13, 18, 0.85);
--border-subtle: rgba(255, 255, 255, 0.06);
--border-accent: rgba(124, 58, 237, 0.3);
--text-primary: #ffffff;
--text-secondary: #a1a1aa;
--text-muted: #71717a;
--accent-purple: #7c3aed;
--accent-blue: #3b82f6;
--accent-cyan: #06b6d4;
--accent-green: #10b981;
--accent-red: #ef4444;
--accent-orange: #f97316;
--gradient-primary: linear-gradient(135deg, #7c3aed 0%, #3b82f6 50%, #06b6d4 100%);
--shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.5);
--shadow-glow: 0 0 40px rgba(124, 58, 237, 0.2);
--radius-md: 12px;
--radius-xl: 24px;
--transition-smooth: cubic-bezier(0.4, 0, 0.2, 1);
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
font-family: 'Inter', sans-serif;
background: var(--bg-dark);
color: var(--text-primary);
min-height: 100vh;
overflow-x: hidden;
position: relative;
}
body::before {
content: '';
position: fixed;
top: 0; left: 0;
width: 100%; height: 100%;
background: radial-gradient(ellipse at 15% 25%, rgba(124, 58, 237, 0.08) 0%, transparent 50%),
radial-gradient(ellipse at 85% 75%, rgba(59, 130, 246, 0.06) 0%, transparent 50%);
pointer-events: none;
z-index: -1;
}
.particles {
position: fixed;
top: 0; left: 0;
width: 100%; height: 100%;
pointer-events: none;
z-index: -1;
overflow: hidden;
}
.particle {
position: absolute;
width: 4px; height: 4px;
background: var(--accent-purple);
border-radius: 50%;
opacity: 0.3;
animation: float 20s infinite;
}
@keyframes float {
0%, 100% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
10% { opacity: 0.3; }
90% { opacity: 0.3; }
100% { transform: translateY(-100vh) rotate(720deg); opacity: 0; }
}
.header {
background: var(--bg-glass);
backdrop-filter: blur(20px);
border-bottom: 1px solid var(--border-subtle);
padding: 1.25rem 3rem;
display: flex;
justify-content: space-between;
align-items: center;
position: sticky;
top: 0;
z-index: 100;
}
.header h1 {
font-family: 'Space Grotesk', sans-serif;
font-weight: 700;
font-size: 1.85rem;
background: var(--gradient-primary);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
cursor: pointer;
flex: 1;
text-align: center;
}
.admin-btn {
background: transparent;
color: var(--text-primary);
border: 1px solid var(--border-accent);
padding: 0.75rem 1.5rem;
border-radius: var(--radius-md);
cursor: pointer;
font-size: 0.9rem;
font-weight: 600;
display: flex;
align-items: center;
gap: 0.5rem;
transition: all 0.4s var(--transition-smooth);
font-family: 'Space Grotesk', sans-serif;
}
.admin-btn:hover {
border-color: transparent;
background: var(--gradient-primary);
transform: translateY(-2px);
box-shadow: 0 8px 24px rgba(124, 58, 237, 0.4);
}
.admin-btn.logout {
border-color: rgba(239, 68, 68, 0.5);
background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
}
.user-info {
display: flex;
align-items: center;
gap: 0.75rem;
font-size: 0.9rem;
color: var(--text-secondary);
background: var(--bg-card);
padding: 0.5rem 1.25rem;
border-radius: var(--radius-md);
border: 1px solid var(--border-subtle);
}
.filters {
padding: 2rem 3rem;
display: flex;
gap: 1rem;
flex-wrap: wrap;
align-items: center;
background: var(--bg-card);
border-bottom: 1px solid var(--border-subtle);
}
.filters select, .filters input {
padding: 0.875rem 1.5rem;
border-radius: 50px;
border: 1px solid var(--border-subtle);
background: var(--bg-dark);
color: var(--text-primary);
font-size: 0.9rem;
min-width: 180px;
outline: none;
}
.filters select:focus, .filters input:focus {
border-color: var(--accent-purple);
box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.15);
}
.video-grid {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
gap: 2.5rem;
padding: 3rem;
}
.video-card {
background: var(--bg-card);
border-radius: var(--radius-xl);
overflow: hidden;
border: 1px solid var(--border-subtle);
transition: all 0.5s var(--transition-smooth);
cursor: pointer;
position: relative;
}
.video-card:hover {
transform: translateY(-12px) scale(1.02);
box-shadow: var(--shadow-lg), var(--shadow-glow);
border-color: var(--border-accent);
}
.card-thumb {
width: 100%;
height: 220px;
background: var(--bg-dark);
display: flex;
align-items: center;
justify-content: center;
position: relative;
overflow: hidden;
}
.card-thumb img {
width: 100%;
height: 100%;
object-fit: cover;
display: none;
}
.card-thumb img.loaded { display: block; }
.card-thumb .placeholder {
color: var(--text-muted);
font-size: 5rem;
}
.type-badge {
position: absolute;
bottom: 12px;
left: 12px;
padding: 0.5rem 1.25rem;
border-radius: 50px;
font-size: 0.8rem;
font-weight: 600;
text-transform: uppercase;
z-index: 5;
backdrop-filter: blur(10px);
opacity: 0;
transform: translateY(10px);
transition: all 0.4s var(--transition-smooth);
}
.video-card:hover .type-badge {
opacity: 1;
transform: translateY(0);
}
.type-youtube { background: linear-gradient(135deg, rgba(239, 68, 68, 0.95) 0%, rgba(220, 38, 38, 0.95) 100%); }
.type-drive { background: linear-gradient(135deg, rgba(59, 130, 246, 0.95) 0%, rgba(37, 99, 235, 0.95) 100%); }
.type-pdf { background: linear-gradient(135deg, rgba(234, 88, 12, 0.95) 0%, rgba(194, 65, 12, 0.95) 100%); }
.type-playlist { background: linear-gradient(135deg, rgba(124, 58, 237, 0.95) 0%, rgba(99, 102, 241, 0.95) 100%); }
.protected-badge {
position: absolute;
top: 16px;
right: 16px;
background: linear-gradient(135deg, rgba(245, 158, 11, 0.9) 0%, rgba(234, 88, 12, 0.9) 100%);
color: white;
width: 42px;
height: 42px;
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
z-index: 10;
}
.admin-actions {
position: absolute;
top: 16px;
left: 16px;
display: flex;
gap: 10px;
z-index: 10;
opacity: 0;
transform: translateY(-15px);
transition: all 0.4s var(--transition-smooth);
}
.video-card:hover .admin-actions {
opacity: 1;
transform: translateY(0);
}
.admin-btn-action {
width: 40px;
height: 40px;
border-radius: var(--radius-md);
border: none;
cursor: pointer;
display: flex;
align-items: center;
justify-content: center;
color: white;
transition: all 0.3s var(--transition-smooth);
backdrop-filter: blur(10px);
}
.admin-btn-action:hover { transform: scale(1.2); }
.notes-btn { background: linear-gradient(135deg, rgba(16, 185, 129, 0.9) 0%, rgba(5, 150, 105, 0.9) 100%); }
.edit-btn { background: linear-gradient(135deg, rgba(124, 58, 237, 0.9) 0%, rgba(59, 130, 246, 0.9) 100%); }
.delete-btn { background: linear-gradient(135deg, rgba(239, 68, 68, 0.9) 0%, rgba(220, 38, 38, 0.9) 100%); }
.card-content { padding: 1.75rem; }
.card-title {
font-family: 'Space Grotesk', sans-serif;
font-size: 1.15rem;
font-weight: 600;
margin-bottom: 0.875rem;
color: var(--text-primary);
overflow: hidden;
display: -webkit-box;
-webkit-line-clamp: 2;
-webkit-box-orient: vertical;
}
.card-meta {
font-size: 0.85rem;
color: var(--text-secondary);
font-weight: 500;
}
.pagination {
padding: 2.5rem 3rem;
display: flex;
justify-content: center;
gap: 0.875rem;
}
.pagination button {
padding: 0.875rem 1.5rem;
background: var(--bg-card);
border: 1px solid var(--border-subtle);
color: var(--text-secondary);
border-radius: var(--radius-md);
cursor: pointer;
font-weight: 600;
}
.pagination button:hover:not(:disabled) {
background: var(--gradient-primary);
color: white;
border-color: transparent;
transform: translateY(-3px);
}
.pagination button.active {
background: var(--gradient-primary);
color: white;
border-color: transparent;
}
#videoPopupModal, #passwordModal, #notesModal, #addVideoModal, #editVideoModal, #authModal, #settingsModal {
display: none;
position: fixed;
top: 0; left: 0;
width: 100vw;
height: 100vh;
background: rgba(0, 0, 0, 0.9);
backdrop-filter: blur(12px);
z-index: 4000;
justify-content: center;
align-items: center;
}
#videoPopupModal {
background: rgba(0, 0, 0, 0.97);
z-index: 3000;
flex-direction: column;
padding: 2rem;
}
#popupControls {
display: flex;
align-items: center;
justify-content: space-between;
width: 90%;
max-width: 1100px;
margin-bottom: 2rem;
}
#popupTitle {
font-family: 'Space Grotesk', sans-serif;
color: var(--text-primary);
font-size: 1.5rem;
font-weight: 600;
text-align: center;
flex: 1;
background: var(--gradient-primary);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
}
#backToListBtn, #closePopup {
background: var(--bg-card);
color: var(--text-primary);
border: 1px solid var(--border-subtle);
width: 50px;
height: 50px;
border-radius: 50%;
cursor: pointer;
display: flex;
align-items: center;
justify-content: center;
transition: all 0.3s var(--transition-smooth);
}
#backToListBtn:hover, #closePopup:hover {
border-color: var(--accent-purple);
transform: scale(1.15);
}
#popupVideoFrame {
width: 90%;
max-width: 1100px;
height: 56.25vw;
max-height: 60vh;
border: none;
border-radius: var(--radius-xl);
}
.modal-content {
background: linear-gradient(145deg, var(--bg-card) 0%, var(--bg-dark) 100%);
backdrop-filter: blur(20px);
padding: 3rem;
border-radius: var(--radius-xl);
width: 90%;
max-width: 600px;
box-shadow: var(--shadow-lg), 0 0 80px rgba(124, 58, 237, 0.2);
border: 1px solid var(--border-accent);
color: var(--text-primary);
max-height: 90vh;
overflow-y: auto;
}
#notesModal .modal-content { max-width: 700px; }
.modal-content h5 {
font-family: 'Space Grotesk', sans-serif;
font-weight: 600;
margin-bottom: 2.5rem;
font-size: 1.65rem;
background: var(--gradient-primary);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
text-align: center;
}
.modal-content .form-label {
color: var(--text-secondary);
font-size: 0.9rem;
font-weight: 500;
margin-bottom: 0.75rem;
}
.modal-content .form-control, .modal-content .form-select {
background: var(--bg-dark);
border: 1px solid var(--border-subtle);
color: var(--text-primary);
padding: 1rem 1.5rem;
border-radius: var(--radius-md);
font-size: 0.95rem;
}
.modal-content .form-control:focus, .modal-content .form-select:focus {
border-color: var(--accent-purple);
box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.15);
}
.modal-content .form-check {
padding: 1.25rem;
background: var(--bg-dark);
border-radius: var(--radius-md);
border: 1px solid var(--border-subtle);
margin-top: 0.75rem;
}
.modal-content .form-check-input:checked {
background-color: var(--accent-purple);
border-color: var(--accent-purple);
}
.modal-content .form-check-label {
color: var(--text-secondary);
margin-left: 0.75rem;
}
#addVideoStatus, #editVideoStatus, #settingsStatus, #notesStatus {
margin-top: 2rem;
font-size: 0.95rem;
padding: 1.25rem;
border-radius: var(--radius-md);
text-align: center;
}
.status-success {
color: var(--accent-green);
background: rgba(16, 185, 129, 0.1);
border: 1px solid rgba(16, 185, 129, 0.2);
}
.status-error {
color: var(--accent-red);
background: rgba(239, 68, 68, 0.1);
border: 1px solid rgba(239, 68, 68, 0.2);
}
.modal-content .btn {
padding: 1rem 2.5rem;
border-radius: var(--radius-md);
font-weight: 600;
transition: all 0.3s var(--transition-smooth);
}
.modal-content .btn-primary {
background: var(--gradient-primary);
border: none;
box-shadow: 0 4px 16px rgba(124, 58, 237, 0.3);
}
.modal-content .btn-primary:hover {
transform: translateY(-3px);
box-shadow: 0 8px 24px rgba(124, 58, 237, 0.4);
}
.modal-content .btn-secondary {
background: var(--bg-dark);
border: 1px solid var(--border-subtle);
color: var(--text-primary);
}
/* Notes Section Styles */
.notes-container { margin-top: 1.5rem; }
.notes-list {
max-height: 300px;
overflow-y: auto;
margin-bottom: 1.5rem;
}
.note-item {
background: var(--bg-dark);
border: 1px solid var(--border-subtle);
border-radius: var(--radius-md);
padding: 1rem;
margin-bottom: 1rem;
}
.note-header {
display: flex;
justify-content: space-between;
align-items: center;
margin-bottom: 0.75rem;
}
.note-date {
font-size: 0.75rem;
color: var(--text-muted);
}
.note-actions { display: flex; gap: 0.5rem; }
.note-actions button {
width: 28px;
height: 28px;
border-radius: 6px;
border: none;
cursor: pointer;
display: flex;
align-items: center;
justify-content: center;
color: white;
font-size: 0.75rem;
}
.note-edit-btn { background: linear-gradient(135deg, rgba(59, 130, 246, 0.9) 0%, rgba(37, 99, 235, 0.9) 100%); }
.note-delete-btn { background: linear-gradient(135deg, rgba(239, 68, 68, 0.9) 0%, rgba(220, 38, 38, 0.9) 100%); }
.note-content {
font-size: 0.9rem;
color: var(--text-secondary);
line-height: 1.5;
white-space: pre-wrap;
}
.note-textarea {
width: 100%;
min-height: 120px;
background: var(--bg-dark);
border: 1px solid var(--border-subtle);
border-radius: var(--radius-md);
color: var(--text-primary);
padding: 1rem;
font-size: 0.95rem;
resize: vertical;
}
.note-textarea:focus {
outline: none;
border-color: var(--accent-purple);
box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.15);
}
.empty-notes {
text-align: center;
padding: 2rem;
color: var(--text-muted);
}
.empty-notes i {
font-size: 3rem;
margin-bottom: 1rem;
opacity: 0.3;
}
.empty-state {
text-align: center;
padding: 5rem 2rem;
color: var(--text-muted);
}
.empty-state i {
font-size: 5rem;
margin-bottom: 1.5rem;
opacity: 0.3;
background: var(--gradient-primary);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
}
@media (max-width: 768px) {
.header { flex-direction: column; gap: 1.25rem; padding: 1.25rem 1.5rem; }
.filters { flex-direction: column; padding: 1.5rem; }
.filters select, .filters input { width: 100%; }
.video-grid { grid-template-columns: 1fr; padding: 1.5rem; }
#popupVideoFrame { height: 45vh; }
}
</style>
</head>
<body>
<div class="particles" id="particles"></div>
<div class="header">
<div style="display: flex; align-items: center; gap: 1rem;">
<button id="adminBtn" class="admin-btn" style="display: none;"><i class="fas fa-plus"></i> Add Video</button>
<button id="settingsBtn" class="admin-btn" style="display: none;"><i class="fas fa-cog"></i> Settings</button>
<button id="authBtn" class="admin-btn"><i class="fas fa-sign-in-alt"></i> Admin Login</button>
</div>
<h1 id="headerTitle"><i class="fa-solid fa-video"></i> NEXUS LIBRARY</h1>
<div class="user-info" id="userInfo" style="display: none;">
<i class="fas fa-user-circle"></i>
<span id="userEmail"></span>
</div>
</div>
<div class="filters">
<select id="categoryFilter"><option value="">All Categories</option></select>
<select id="subcategoryFilter"><option value="">All Subcategories</option></select>
<select id="topicFilter"><option value="">All Topics</option></select>
<input type="text" id="searchBox" placeholder="Search videos..." autocomplete="off">
</div>
<div class="video-grid" id="videoGrid"><div class="empty-state"><i class="fas fa-spinner fa-spin"></i><p>Loading library...</p></div></div>
<div class="pagination" id="pagination"></div>

<!-- Video Popup Modal -->
<div id="videoPopupModal">
<div id="popupControls">
<button id="backToListBtn"><i class="fas fa-arrow-left"></i></button>
<div id="popupTitle"></div>
<button id="closePopup"><i class="fas fa-times"></i></button>
</div>
<iframe id="popupVideoFrame" allowfullscreen></iframe>
</div>

<!-- Password Modal -->
<div id="passwordModal">
<div class="modal-content">
<h5><i class="fas fa-lock me-2"></i>Secure Access</h5>
<input type="password" id="videoPassword" class="form-control" placeholder="Enter access code" autocomplete="off">
<p id="passwordError" class="status-error" style="display:none;">Incorrect password</p>
<div class="d-flex justify-content-between mt-4">
<button id="cancelPassword" class="btn btn-secondary">Cancel</button>
<button id="submitPassword" class="btn btn-primary">Unlock</button>
</div>
</div>
</div>

<!-- Notes Modal -->
<div id="notesModal">
<div class="modal-content">
<h5><i class="fas fa-sticky-note me-2"></i>Video Notes</h5>
<div id="notesVideoTitle" style="text-align: center; color: var(--text-secondary); margin-bottom: 1.5rem;"></div>
<div class="notes-container">
<div class="notes-list" id="notesList">
<div class="empty-notes"><i class="fas fa-clipboard"></i><p>No notes yet. Add your first note!</p></div>
</div>
<div class="mb-3">
<label class="form-label"><i class="fas fa-pen me-2"></i>Add/Edit Note</label>
<textarea id="noteTextarea" class="note-textarea" placeholder="Write your notes here..."></textarea>
</div>
<div id="notesStatus"></div>
<div class="d-flex justify-content-between mt-4">
<button id="cancelNotes" class="btn btn-secondary">Close</button>
<button id="saveNote" class="btn btn-primary"><i class="fas fa-save me-2"></i>Save Note</button>
</div>
</div>
</div>
</div>

<!-- Add Video Modal -->
<div id="addVideoModal">
<div class="modal-content">
<h5><i class="fas fa-upload me-2"></i>Add New Video</h5>
<form id="addVideoForm">
<div class="mb-3"><label class="form-label">Title</label><input type="text" id="newTitle" class="form-control" required></div>
<div class="mb-3"><label class="form-label">Type</label>
<select id="newType" class="form-select" required>
<option value="youtube">YouTube</option>
<option value="drive">Google Drive</option>
<option value="pdf">PDF</option>
<option value="youtube-playlist">YouTube Playlist</option>
</select>
</div>
<div class="mb-3"><label class="form-label">ID / URL</label><input type="text" id="newId" class="form-control" required></div>
<div class="mb-3" id="newFirstVideoIdGroup" style="display:none;">
<label class="form-label">First Video ID (for Thumbnail)</label>
<input type="text" id="newFirstVideoId" class="form-control" placeholder="e.g., dQw4w9WgXcQ">
</div>
<div class="mb-3"><label class="form-label">Category</label><input type="text" id="newCategory" class="form-control" list="categoryList" required><datalist id="categoryList"></datalist></div>
<div class="mb-3"><label class="form-label">Subcategory</label><input type="text" id="newSubcategory" class="form-control" list="subcategoryList"><datalist id="subcategoryList"></datalist></div>
<div class="mb-3"><label class="form-label">Topic</label><input type="text" id="newTopic" class="form-control" list="topicList"><datalist id="topicList"></datalist></div>
<div class="mb-3 form-check"><input type="checkbox" class="form-check-input" id="newProtected"><label class="form-check-label">Password Protected</label></div>
<div id="addVideoStatus"></div>
<div class="d-flex justify-content-between mt-4">
<button type="button" id="cancelAddVideo" class="btn btn-secondary">Cancel</button>
<button type="submit" class="btn btn-primary">Save Video</button>
</div>
</form>
</div>
</div>

<!-- Edit Video Modal -->
<div id="editVideoModal">
<div class="modal-content">
<h5><i class="fas fa-edit me-2"></i>Edit Video</h5>
<form id="editVideoForm">
<input type="hidden" id="editVideoId">
<div class="mb-3"><label class="form-label">Title</label><input type="text" id="editTitle" class="form-control" required></div>
<div class="mb-3"><label class="form-label">Type</label>
<select id="editType" class="form-select" required>
<option value="youtube">YouTube</option>
<option value="drive">Google Drive</option>
<option value="pdf">PDF</option>
<option value="youtube-playlist">YouTube Playlist</option>
</select>
</div>
<div class="mb-3"><label class="form-label">ID / URL</label><input type="text" id="editId" class="form-control" required></div>
<div class="mb-3" id="editFirstVideoIdGroup" style="display:none;">
<label class="form-label">First Video ID (for Thumbnail)</label>
<input type="text" id="editFirstVideoId" class="form-control">
</div>
<div class="mb-3"><label class="form-label">Category</label><input type="text" id="editCategory" class="form-control" list="categoryList" required></div>
<div class="mb-3"><label class="form-label">Subcategory</label><input type="text" id="editSubcategory" class="form-control" list="subcategoryList"></div>
<div class="mb-3"><label class="form-label">Topic</label><input type="text" id="editTopic" class="form-control" list="topicList"></div>
<div class="mb-3 form-check"><input type="checkbox" class="form-check-input" id="editProtected"><label class="form-check-label">Password Protected</label></div>
<div id="editVideoStatus"></div>
<div class="d-flex justify-content-between mt-4">
<button type="button" id="cancelEditVideo" class="btn btn-secondary">Cancel</button>
<button type="submit" class="btn btn-primary">Update Video</button>
</div>
</form>
</div>
</div>

<!-- Settings Modal -->
<div id="settingsModal">
<div class="modal-content">
<h5><i class="fas fa-cog me-2"></i>Security Settings</h5>
<form id="settingsForm">
<div class="mb-3"><label class="form-label">New Video Password</label><input type="text" id="newVideoPassword" class="form-control" required></div>
<div class="mb-3"><label class="form-label">Confirm Password</label><input type="text" id="confirmVideoPassword" class="form-control" required></div>
<div id="settingsStatus"></div>
<div class="d-flex justify-content-between mt-4">
<button type="button" id="cancelSettings" class="btn btn-secondary">Cancel</button>
<button type="submit" class="btn btn-primary">Update Password</button>
</div>
</form>
</div>
</div>

<!-- Auth Modal -->
<div id="authModal">
<div class="modal-content">
<h5 id="authTitle"><i class="fas fa-sign-in-alt me-2"></i>Admin Login</h5>
<form id="authForm">
<div class="mb-3"><label class="form-label">Email</label><input type="email" id="authEmail" class="form-control" required></div>
<div class="mb-3"><label class="form-label">Password</label><input type="password" id="authPassword" class="form-control" required></div>
<p id="authError" class="status-error"></p>
<div class="d-flex justify-content-between mt-4">
<button type="button" id="cancelAuth" class="btn btn-secondary">Cancel</button>
<button type="submit" class="btn btn-primary">Login</button>
</div>
</form>
</div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, onSnapshot, query, orderBy, deleteDoc, doc, updateDoc, serverTimestamp, setDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

const firebaseConfig = {
apiKey: "AIzaSyB82MwSrGp35eS2ZXBsBlhie6EL6s-5HK0",
authDomain: "videolibrary-4709d.firebaseapp.com",
projectId: "videolibrary-4709d",
storageBucket: "videolibrary-4709d.firebasestorage.app",
messagingSenderId: "752788156798",
appId: "1:752788156798:web:df6dc050abc7de4150432f"
};

let db, auth;
try {
const app = initializeApp(firebaseConfig);
db = getFirestore(app);
auth = getAuth(app);
console.log("‚úÖ Firebase initialized");
} catch (e) {
console.error("Firebase init error:", e);
}

const VIDEOS_PER_PAGE = 100;
let allVideos = [];
let filteredVideos = [];
let currentPage = 1;
let videoPassword = "Animator";
let currentUser = null;
let editingVideoId = null;
let currentVideo = null;
let currentNotesVideoId = null;
let currentNoteId = null;
let notesUnsubscribe = null;

// DOM Elements
const categoryFilter = document.getElementById('categoryFilter');
const subcategoryFilter = document.getElementById('subcategoryFilter');
const topicFilter = document.getElementById('topicFilter');
const searchBox = document.getElementById('searchBox');
const videoGrid = document.getElementById('videoGrid');
const paginationEl = document.getElementById('pagination');
const popupModal = document.getElementById('videoPopupModal');
const popupFrame = document.getElementById('popupVideoFrame');
const popupTitle = document.getElementById('popupTitle');
const closePopup = document.getElementById('closePopup');
const backToListBtn = document.getElementById('backToListBtn');
const passwordModal = document.getElementById('passwordModal');
const videoPasswordInput = document.getElementById('videoPassword');
const submitPassword = document.getElementById('submitPassword');
const cancelPassword = document.getElementById('cancelPassword');
const passwordError = document.getElementById('passwordError');
const headerTitle = document.getElementById('headerTitle');
const adminBtn = document.getElementById('adminBtn');
const settingsBtn = document.getElementById('settingsBtn');
const authBtn = document.getElementById('authBtn');
const userInfo = document.getElementById('userInfo');
const userEmail = document.getElementById('userEmail');
const addVideoModal = document.getElementById('addVideoModal');
const addVideoForm = document.getElementById('addVideoForm');
const cancelAddVideo = document.getElementById('cancelAddVideo');
const addVideoStatus = document.getElementById('addVideoStatus');
const editVideoModal = document.getElementById('editVideoModal');
const editVideoForm = document.getElementById('editVideoForm');
const cancelEditVideo = document.getElementById('cancelEditVideo');
const editVideoStatus = document.getElementById('editVideoStatus');
const settingsModal = document.getElementById('settingsModal');
const settingsForm = document.getElementById('settingsForm');
const cancelSettings = document.getElementById('cancelSettings');
const settingsStatus = document.getElementById('settingsStatus');
const newVideoPassword = document.getElementById('newVideoPassword');
const confirmVideoPassword = document.getElementById('confirmVideoPassword');
const categoryList = document.getElementById('categoryList');
const subcategoryList = document.getElementById('subcategoryList');
const topicList = document.getElementById('topicList');
const authModal = document.getElementById('authModal');
const authForm = document.getElementById('authForm');
const authEmail = document.getElementById('authEmail');
const authPassword = document.getElementById('authPassword');
const authError = document.getElementById('authError');
const cancelAuth = document.getElementById('cancelAuth');
const newFirstVideoIdGroup = document.getElementById('newFirstVideoIdGroup');
const newFirstVideoId = document.getElementById('newFirstVideoId');
const editFirstVideoIdGroup = document.getElementById('editFirstVideoIdGroup');
const editFirstVideoId = document.getElementById('editFirstVideoId');
const newTypeSelect = document.getElementById('newType');
const editTypeSelect = document.getElementById('editType');

// Notes Modal Elements
const notesModal = document.getElementById('notesModal');
const notesList = document.getElementById('notesList');
const noteTextarea = document.getElementById('noteTextarea');
const saveNote = document.getElementById('saveNote');
const cancelNotes = document.getElementById('cancelNotes');
const notesStatus = document.getElementById('notesStatus');
const notesVideoTitle = document.getElementById('notesVideoTitle');

// Create Particles
function createParticles() {
const container = document.getElementById('particles');
for (let i = 0; i < 30; i++) {
const particle = document.createElement('div');
particle.className = 'particle';
particle.style.left = Math.random() * 100 + '%';
particle.style.animationDelay = Math.random() * 20 + 's';
container.appendChild(particle);
}
}
createParticles();

// Load Password
function loadVideoPassword() {
if (!db) return;
onSnapshot(doc(db, "settings", "videoPassword"), (docSnap) => {
if (docSnap.exists()) {
videoPassword = docSnap.data().password || "Animator";
} else {
setDoc(doc(db, "settings", "videoPassword"), { password: "Animator", updatedAt: serverTimestamp() });
}
});
}
loadVideoPassword();

// Auth State
if (auth) {
onAuthStateChanged(auth, (user) => {
currentUser = user;
if (user) {
adminBtn.style.display = 'flex';
settingsBtn.style.display = 'flex';
authBtn.innerHTML = '<i class="fas fa-sign-out-alt"></i> Logout';
authBtn.classList.add('logout');
userInfo.style.display = 'flex';
userEmail.textContent = user.email;
} else {
adminBtn.style.display = 'none';
settingsBtn.style.display = 'none';
authBtn.innerHTML = '<i class="fas fa-sign-in-alt"></i> Admin Login';
authBtn.classList.remove('logout');
userInfo.style.display = 'none';
}
renderVideos();
});
}

// Load Videos
if (db) {
onSnapshot(query(collection(db, "videos"), orderBy("createdAt", "desc")), (snapshot) => {
allVideos = snapshot.docs.map(doc => ({ firestoreId: doc.id, ...doc.data() }));
updateDataLists();
populateFilters();
applyFilters();
});
}

// Helper Functions
function getYouTubeId(url) {
if (!url) return null;
const match = url.trim().match(/^.*(youtu\.be\/|v\/|embed\/|watch\?v=)([^#&?]*).*/);
return (match && match[2].length === 11) ? match[2] : null;
}

function getThumbnailUrl(item) {
if (item.type === "youtube") {
const id = getYouTubeId(item.url || item.id);
return id ? `https://img.youtube.com/vi/${id}/mqdefault.jpg` : null;
} else if (item.type === "youtube-playlist") {
return item.firstVideoId ? `https://img.youtube.com/vi/${item.firstVideoId}/mqdefault.jpg` : null;
} else if ((item.type === "drive" || item.type === "pdf") && item.id) {
return `https://drive.google.com/thumbnail?id=${item.id}&sz=w640`;
}
return null;
}

function getEmbedUrl(item) {
if (item.type === "youtube") {
const id = getYouTubeId(item.url || item.id);
return id ? `https://www.youtube.com/embed/${id}?autoplay=1` : null;
} else if (item.type === "youtube-playlist") {
return `https://www.youtube.com/embed/videoseries?list=${item.id}&autoplay=1`;
} else if ((item.type === "drive" || item.type === "pdf") && item.id) {
return `https://drive.google.com/file/d/${item.id}/preview`;
}
return null;
}

function getTypeBadge(type) {
return { 'youtube': 'YouTube', 'drive': 'Drive', 'pdf': 'PDF', 'youtube-playlist': 'Playlist' }[type] || 'Video';
}

function getTypeClass(type) {
return { 'youtube': 'type-youtube', 'drive': 'type-drive', 'pdf': 'type-pdf', 'youtube-playlist': 'type-playlist' }[type] || '';
}

function getTypeIcon(type) {
return { 'youtube': 'fa-youtube', 'drive': 'fa-google-drive', 'pdf': 'fa-file-pdf', 'youtube-playlist': 'fa-list' }[type] || 'fa-video';
}

function updateDataLists() {
const cats = [...new Set(allVideos.map(v => v.category).filter(Boolean))].sort();
const subs = [...new Set(allVideos.map(v => v.subcategory).filter(Boolean))].sort();
const tops = [...new Set(allVideos.map(v => v.topic).filter(Boolean))].sort();
categoryList.innerHTML = cats.map(c => `<option value="${c}">`).join('');
subcategoryList.innerHTML = subs.map(s => `<option value="${s}">`).join('');
topicList.innerHTML = tops.map(t => `<option value="${t}">`).join('');
}

function populateFilters() {
const cats = [...new Set(allVideos.map(v => (v.category || "Uncategorized").trim()))].sort();
categoryFilter.innerHTML = '<option value="">All Categories</option>';
cats.forEach(cat => {
const opt = document.createElement('option');
opt.value = cat;
opt.textContent = cat;
categoryFilter.appendChild(opt);
});
updateSubcategories();
}

function updateSubcategories() {
const cat = categoryFilter.value.trim();
subcategoryFilter.innerHTML = '<option value="">All Subcategories</option>';
topicFilter.innerHTML = '<option value="">All Topics</option>';
if (!cat) return;
const subs = [...new Set(allVideos.filter(v => v.category === cat).map(v => v.subcategory).filter(Boolean))].sort();
subs.forEach(sub => {
const opt = document.createElement('option');
opt.value = sub;
opt.textContent = sub;
subcategoryFilter.appendChild(opt);
});
updateTopics();
}

function updateTopics() {
const cat = categoryFilter.value.trim();
const sub = subcategoryFilter.value.trim();
topicFilter.innerHTML = '<option value="">All Topics</option>';
if (!cat || !sub) return;
const topics = [...new Set(allVideos.filter(v => v.category === cat && v.subcategory === sub).map(v => v.topic).filter(Boolean))].sort();
topics.forEach(top => {
const opt = document.createElement('option');
opt.value = top;
opt.textContent = top;
topicFilter.appendChild(opt);
});
}

function toggleFirstVideoIdField(type, prefix) {
const group = prefix === 'new' ? newFirstVideoIdGroup : editFirstVideoIdGroup;
group.style.display = type === 'youtube-playlist' ? 'block' : 'none';
}

// Create Video Card
function createVideoCard(video) {
const card = document.createElement('div');
card.className = 'video-card';
const thumbUrl = getThumbnailUrl(video);
const meta = [video.category, video.subcategory, video.topic].filter(Boolean).join(' ‚Ä¢ ');

let thumbHtml = thumbUrl ? `<img src="${thumbUrl}" class="loaded">` : `<div class="placeholder"><i class="fas ${getTypeIcon(video.type)}"></i></div>`;

const typeBadge = `<div class="type-badge ${getTypeClass(video.type)}"><i class="fas ${getTypeIcon(video.type)} me-1"></i>${getTypeBadge(video.type)}</div>`;

const adminActionsHtml = currentUser ? `
<div class="admin-actions">
<button class="admin-btn-action notes-btn" title="Notes"><i class="fas fa-sticky-note"></i></button>
<button class="admin-btn-action edit-btn" title="Edit"><i class="fas fa-edit"></i></button>
<button class="admin-btn-action delete-btn" title="Delete"><i class="fas fa-trash"></i></button>
</div>` : '';

card.innerHTML = `
<div class="card-thumb">
${thumbHtml}
${typeBadge}
${video.protected ? `<div class="protected-badge"><i class="fas fa-lock"></i></div>` : ''}
${adminActionsHtml}
</div>
<div class="card-content">
<div class="card-title">${video.title}</div>
<div class="card-meta">${meta}</div>
</div>`;

if (currentUser) {
// Notes Button
const notesBtn = card.querySelector('.notes-btn');
if (notesBtn) {
notesBtn.addEventListener('click', (e) => {
e.stopPropagation();
openNotesModal(video);
});
}
// Edit Button
const editBtn = card.querySelector('.edit-btn');
if (editBtn) {
editBtn.addEventListener('click', (e) => {
e.stopPropagation();
openEditModal(video);
});
}
// Delete Button
const deleteBtn = card.querySelector('.delete-btn');
if (deleteBtn) {
deleteBtn.addEventListener('click', async (e) => {
e.stopPropagation();
if (confirm(`Delete "${video.title}"?`)) {
await deleteDoc(doc(db, "videos", video.firestoreId));
}
});
}
}

if (thumbUrl) {
const img = card.querySelector('img');
img.onerror = () => { img.style.display = 'none'; card.querySelector('.placeholder').style.display = 'flex'; };
}

card.addEventListener('click', () => openVideo(video));
return card;
}

// ============================================
// üìù NOTES FUNCTIONS (FIXED)
// ============================================
function openNotesModal(video) {
currentNotesVideoId = video.firestoreId;
notesVideoTitle.textContent = `üìπ ${video.title}`;
noteTextarea.value = '';
currentNoteId = null;
notesStatus.textContent = '';
notesModal.style.display = 'flex';
loadNotesForVideo(video.firestoreId);
}

function loadNotesForVideo(videoId) {
if (!db) {
notesList.innerHTML = `<div class="empty-notes"><i class="fas fa-exclamation-triangle"></i><p>Database not connected</p></div>`;
return;
}

if (!currentUser) {
notesList.innerHTML = `<div class="empty-notes"><i class="fas fa-lock"></i><p>Please login to view notes</p></div>`;
return;
}

// Unsubscribe from previous listener if exists
if (notesUnsubscribe) {
notesUnsubscribe();
notesUnsubscribe = null;
}

console.log("üìù Loading notes for video:", videoId, "User:", currentUser.uid);

// Listen to notes collection in real-time
notesUnsubscribe = onSnapshot(
query(collection(db, "notes"), orderBy("createdAt", "desc")),
(snapshot) => {
console.log("üìù Notes snapshot received:", snapshot.size, "notes");
const allNotes = snapshot.docs.map(doc => ({ noteId: doc.id, ...doc.data() }));
// Filter notes for this video AND this user
const videoNotes = allNotes.filter(note => note.videoId === videoId && note.userId === currentUser.uid);

console.log("üìù Filtered notes for this video:", videoNotes.length);

if (videoNotes.length === 0) {
notesList.innerHTML = `<div class="empty-notes"><i class="fas fa-clipboard"></i><p>No notes yet. Add your first note!</p></div>`;
} else {
notesList.innerHTML = videoNotes.map(note => `
<div class="note-item" data-note-id="${note.noteId}">
<div class="note-header">
<span class="note-date"><i class="fas fa-clock me-1"></i>${formatDate(note.createdAt)}</span>
<div class="note-actions">
<button class="note-edit-btn" title="Edit"><i class="fas fa-edit"></i></button>
<button class="note-delete-btn" title="Delete"><i class="fas fa-trash"></i></button>
</div>
</div>
<div class="note-content">${escapeHtml(note.content)}</div>
</div>`).join('');

// Add event listeners for note actions
document.querySelectorAll('.note-edit-btn').forEach(btn => {
btn.addEventListener('click', (e) => {
const noteItem = e.target.closest('.note-item');
currentNoteId = noteItem.getAttribute('data-note-id');
noteTextarea.value = noteItem.querySelector('.note-content').textContent;
notesStatus.textContent = '‚úèÔ∏è Editing note...';
notesStatus.className = '';
});
});

document.querySelectorAll('.note-delete-btn').forEach(btn => {
btn.addEventListener('click', async (e) => {
const noteItem = e.target.closest('.note-item');
if (confirm('Delete this note?')) {
try {
await deleteDoc(doc(db, "notes", noteItem.getAttribute('data-note-id')));
notesStatus.textContent = '‚úÖ Note deleted!';
notesStatus.className = 'status-success';
setTimeout(() => notesStatus.textContent = '', 2000);
} catch (error) {
console.error("Error deleting note:", error);
notesStatus.textContent = '‚ùå Failed to delete';
notesStatus.className = 'status-error';
}
}
});
});
}
},
(error) => {
console.error("‚ùå Error loading notes:", error);
notesList.innerHTML = `<div class="empty-notes"><i class="fas fa-exclamation-triangle"></i><p>Error: ${error.message}</p><p style="font-size:0.8rem; margin-top:0.5rem;">Check Firebase console & security rules</p></div>`;
}
);
}

function formatDate(timestamp) {
if (!timestamp) return 'Unknown';
try {
return timestamp.toDate().toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' });
} catch (e) {
return 'Unknown';
}
}

function escapeHtml(text) {
const div = document.createElement('div');
div.textContent = text;
return div.innerHTML;
}

// Save Note
saveNote.addEventListener('click', async () => {
if (!currentUser) {
notesStatus.textContent = '‚ùå Please login to save notes';
notesStatus.className = 'status-error';
return;
}
const content = noteTextarea.value.trim();
if (!content) {
notesStatus.textContent = '‚ùå Note cannot be empty';
notesStatus.className = 'status-error';
return;
}
try {
if (currentNoteId) {
// Update existing note
await updateDoc(doc(db, "notes", currentNoteId), { content, updatedAt: serverTimestamp() });
notesStatus.textContent = '‚úÖ Note updated!';
} else {
// Create new note
await addDoc(collection(db, "notes"), {
videoId: currentNotesVideoId,
userId: currentUser.uid,
userEmail: currentUser.email,
content,
createdAt: serverTimestamp(),
updatedAt: serverTimestamp()
});
notesStatus.textContent = '‚úÖ Note saved!';
}
notesStatus.className = 'status-success';
noteTextarea.value = '';
currentNoteId = null;
setTimeout(() => notesStatus.textContent = '', 2000);
} catch (error) {
console.error("Error saving note:", error);
notesStatus.textContent = `‚ùå Failed: ${error.message}`;
notesStatus.className = 'status-error';
}
});

cancelNotes.addEventListener('click', () => {
if (notesUnsubscribe) {
notesUnsubscribe();
notesUnsubscribe = null;
}
notesModal.style.display = 'none';
currentNotesVideoId = null;
currentNoteId = null;
notesStatus.textContent = '';
});

// Filtering & Rendering
function applyFilters() {
let list = [...allVideos];
const cat = categoryFilter.value.trim();
const sub = subcategoryFilter.value.trim();
const top = topicFilter.value.trim();
const query = searchBox.value.trim().toLowerCase();

if (cat) list = list.filter(v => v.category === cat);
if (sub) list = list.filter(v => v.subcategory === sub);
if (top) list = list.filter(v => v.topic === top);
if (query) {
list = list.filter(v => v.title.toLowerCase().includes(query) || v.category?.toLowerCase().includes(query));
}

filteredVideos = list;
currentPage = 1;
renderVideos();
}

function renderVideos() {
if (!allVideos.length) {
videoGrid.innerHTML = `<div class="empty-state"><i class="fas fa-inbox"></i><p>No videos found</p></div>`;
paginationEl.innerHTML = '';
return;
}
const totalPages = Math.max(1, Math.ceil(filteredVideos.length / VIDEOS_PER_PAGE));
currentPage = Math.min(currentPage, totalPages);
const pageVideos = filteredVideos.slice((currentPage - 1) * VIDEOS_PER_PAGE, currentPage * VIDEOS_PER_PAGE);
videoGrid.innerHTML = '';
pageVideos.forEach(v => videoGrid.appendChild(createVideoCard(v)));
renderPagination(totalPages);
}

function renderPagination(totalPages) {
paginationEl.innerHTML = '';
if (totalPages <= 1) return;
for (let i = 1; i <= totalPages; i++) {
const btn = document.createElement('button');
btn.textContent = i;
if (i === currentPage) btn.classList.add('active');
btn.onclick = () => { currentPage = i; renderVideos(); };
paginationEl.appendChild(btn);
}
}

// Video Playback
function openVideo(video) {
if (video.protected && !currentUser) {
currentVideo = video;
passwordModal.style.display = 'flex';
videoPasswordInput.value = '';
passwordError.style.display = 'none';
} else {
playInPopup(video);
}
}

function playInPopup(video) {
const url = getEmbedUrl(video);
if (!url) { alert("Content not available"); return; }
popupTitle.textContent = video.title;
popupFrame.src = url;
popupModal.style.display = 'flex';
}

function validatePassword() {
if (videoPasswordInput.value === videoPassword) {
passwordModal.style.display = 'none';
if (currentVideo) { playInPopup(currentVideo); currentVideo = null; }
} else {
passwordError.style.display = 'block';
}
}

// Auth
authBtn.addEventListener('click', () => {
if (currentUser) { signOut(auth); } else { authModal.style.display = 'flex'; }
});

authForm.addEventListener('submit', async (e) => {
e.preventDefault();
try {
await signInWithEmailAndPassword(auth, authEmail.value, authPassword.value);
authModal.style.display = 'none';
} catch (error) {
authError.textContent = error.message;
authError.style.display = 'block';
}
});

// Add Video
adminBtn.addEventListener('click', () => {
if (currentUser) {
addVideoModal.style.display = 'flex';
toggleFirstVideoIdField(newTypeSelect.value, 'new');
}
});

cancelAddVideo.addEventListener('click', () => {
addVideoModal.style.display = 'none';
addVideoForm.reset();
});

newTypeSelect.addEventListener('change', () => toggleFirstVideoIdField(newTypeSelect.value, 'new'));
editTypeSelect.addEventListener('change', () => toggleFirstVideoIdField(editTypeSelect.value, 'edit'));

addVideoForm.addEventListener('submit', async (e) => {
e.preventDefault();
const newVideo = {
title: document.getElementById('newTitle').value,
type: document.getElementById('newType').value,
id: document.getElementById('newId').value,
url: document.getElementById('newId').value,
firstVideoId: document.getElementById('newFirstVideoId').value.trim(),
category: document.getElementById('newCategory').value,
subcategory: document.getElementById('newSubcategory').value,
topic: document.getElementById('newTopic').value,
protected: document.getElementById('newProtected').checked,
createdAt: serverTimestamp(),
addedBy: currentUser.email
};
await addDoc(collection(db, "videos"), newVideo);
addVideoStatus.textContent = '‚úÖ Added!';
addVideoStatus.className = 'status-success';
setTimeout(() => { addVideoModal.style.display = 'none'; }, 1500);
});

// Edit Video
function openEditModal(video) {
editingVideoId = video.firestoreId;
document.getElementById('editVideoId').value = video.firestoreId;
document.getElementById('editTitle').value = video.title;
document.getElementById('editType').value = video.type;
document.getElementById('editId').value = video.id || video.url;
document.getElementById('editFirstVideoId').value = video.firstVideoId || '';
document.getElementById('editCategory').value = video.category || '';
document.getElementById('editSubcategory').value = video.subcategory || '';
document.getElementById('editTopic').value = video.topic || '';
document.getElementById('editProtected').checked = video.protected || false;
toggleFirstVideoIdField(video.type, 'edit');
editVideoModal.style.display = 'flex';
}

cancelEditVideo.addEventListener('click', () => { editVideoModal.style.display = 'none'; });

editVideoForm.addEventListener('submit', async (e) => {
e.preventDefault();
await updateDoc(doc(db, "videos", editingVideoId), {
title: document.getElementById('editTitle').value,
type: document.getElementById('editType').value,
id: document.getElementById('editId').value,
url: document.getElementById('editId').value,
firstVideoId: document.getElementById('editFirstVideoId').value.trim(),
category: document.getElementById('editCategory').value,
subcategory: document.getElementById('editSubcategory').value,
topic: document.getElementById('editTopic').value,
protected: document.getElementById('editProtected').checked,
updatedAt: serverTimestamp()
});
editVideoStatus.textContent = '‚úÖ Updated!';
editVideoStatus.className = 'status-success';
setTimeout(() => { editVideoModal.style.display = 'none'; }, 1500);
});

// Settings
settingsBtn.addEventListener('click', () => { if (currentUser) settingsModal.style.display = 'flex'; });
cancelSettings.addEventListener('click', () => { settingsModal.style.display = 'none'; });

settingsForm.addEventListener('submit', async (e) => {
e.preventDefault();
if (newVideoPassword.value !== confirmVideoPassword.value) {
settingsStatus.textContent = '‚ùå Passwords do not match';
settingsStatus.className = 'status-error';
return;
}
await setDoc(doc(db, "settings", "videoPassword"), { password: newVideoPassword.value, updatedAt: serverTimestamp() });
videoPassword = newVideoPassword.value;
settingsStatus.textContent = '‚úÖ Password updated!';
settingsStatus.className = 'status-success';
setTimeout(() => { settingsModal.style.display = 'none'; }, 1500);
});

// Event Listeners
categoryFilter.addEventListener('change', () => { updateSubcategories(); updateTopics(); applyFilters(); });
subcategoryFilter.addEventListener('change', () => { updateTopics(); applyFilters(); });
topicFilter.addEventListener('change', () => { applyFilters(); });
searchBox.addEventListener('input', () => { applyFilters(); });
headerTitle.addEventListener('click', () => { categoryFilter.value = ''; subcategoryFilter.value = ''; topicFilter.value = ''; searchBox.value = ''; updateSubcategories(); updateTopics(); applyFilters(); });
closePopup.addEventListener('click', () => { popupModal.style.display = 'none'; popupFrame.src = ''; });
backToListBtn.addEventListener('click', () => { popupModal.style.display = 'none'; popupFrame.src = ''; });
submitPassword.addEventListener('click', validatePassword);
videoPasswordInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') validatePassword(); });
cancelPassword.addEventListener('click', () => { passwordModal.style.display = 'none'; currentVideo = null; });
cancelAuth.addEventListener('click', () => { authModal.style.display = 'none'; });

document.addEventListener('keydown', (e) => {
if (e.key === 'Escape') {
passwordModal.style.display = 'none';
popupModal.style.display = 'none'; popupFrame.src = '';
addVideoModal.style.display = 'none';
editVideoModal.style.display = 'none';
settingsModal.style.display = 'none';
if (notesUnsubscribe) { notesUnsubscribe(); notesUnsubscribe = null; }
notesModal.style.display = 'none';
authModal.style.display = 'none';
}
});
</script>
</body>
</html>
